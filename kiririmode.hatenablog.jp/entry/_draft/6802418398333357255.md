---
Title: syftとgrypeでJavaとNode.jsプロジェクトの依存関係と脆弱性を可視化する
Category:
- Security
- Development
- Java
- Node.js
- SBOM
Date: 2025-03-03T03:52:01Z
URL: https://kiririmode.hatenablog.jp/entry/20250303/1709436721
EditURL: https://blog.hatena.ne.jp/kiririmode/kiririmode.hatenablog.jp/atom/entry/6802418398333357255
---

最近、サプライチェーン攻撃が増加し、プロジェクトの依存関係管理と脆弱性対策の重要性が高まっています。特にJavaやNode.jsのプロジェクトでは、数多くの依存パッケージを利用することが一般的となっており、これらの依存関係を可視化し、潜在的な脆弱性を検知することが重要な課題となっています。

[:contents]

# syftとgrypeとは

## syft：依存関係の可視化ツール
syftは、Anchore社が開発したソフトウェアコンポーネントの依存関係を分析し、SBOMを生成するツールです。SBOMとは「Software Bill of Materials」の略で、ソフトウェアの構成要素を一覧化したものとなります。

以下のような特徴があります。

- 多様なパッケージマネージャーのサポート（Maven、npm、etc）
- 複数のフォーマット（JSON、SPDX、CycloneDX）でのSBOM生成
- コンテナイメージの解析にも対応
- CI/CDパイプラインへの組み込みが容易

## grype：脆弱性スキャンツール
grypeもAnchore社が開発した脆弱性スキャンツールで、syftと連携して動作します。主な特徴は以下の通りです。

- 最新の脆弱性データベースを活用
- 重要度に基づく脆弱性の分類
- 豊富な出力フォーマット
- 高速な脆弱性スキャン

# インストールと基本的な使い方

## インストール方法
まず、syftとgrypeをインストールします。

```bash
# syftのインストール
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin

# grypeのインストール
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin
```

## 基本的なコマンド
syftとgrypeの基本的な使い方を見ていきましょう。

```bash
# SBOMの生成
syft <対象> -o json > sbom.json

# 脆弱性スキャン
grype <対象>
```

# Javaプロジェクト（pom.xml）の解析

## 依存関係の可視化
Maven（pom.xml）プロジェクトの依存関係を解析してみましょう。

```bash
syft dir:/path/to/java-project -o json
```

以下のような形式でプロジェクトの依存関係が出力されます。

```json
{
  "artifacts": [
    {
      "name": "spring-boot-starter-web",
      "version": "2.7.0",
      "type": "java-archive"
    },
    ...
  ]
}
```

## 脆弱性の検知
続いて、grypeを使って脆弱性をスキャンします。

```bash
grype dir:/path/to/java-project
```

出力例：
```text
✗ HIGH: Remote code execution in spring-core (CVE-2022-22965)
  --> java-archive://spring-core@5.3.18
      fixed by upgrading to spring-core@5.3.19
```

# Node.jsプロジェクト（package.json）の解析

## 依存関係の可視化
Node.jsプロジェクトの解析も同様に行えます。

```bash
syft dir:/path/to/node-project -o json
```

出力される依存関係の例：

```json
{
  "artifacts": [
    {
      "name": "express",
      "version": "4.17.1",
      "type": "npm"
    },
    ...
  ]
}
```

## 脆弱性の検知
package.jsonに記載された依存パッケージの脆弱性をスキャンします。

```bash
grype dir:/path/to/node-project
```

出力例：
```text
✗ CRITICAL: Prototype Pollution in minimist (CVE-2020-7598)
  --> npm://minimist@1.2.5
      fixed by upgrading to minimist@1.2.6
```

# CI/CDパイプラインでの活用

syftとgrypeは、CI/CDパイプラインに組み込むことで、継続的な脆弱性管理を実現できます。以下はGitHub Actionsでの設定例です。

```yaml
name: Security Scan
on: [push]

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Run Syft
        run: |
          curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin
          syft . -o json > sbom.json
          
      - name: Run Grype
        run: |
          curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh | sh -s -- -b /usr/local/bin
          grype .
```

# 実践的な使用のポイント

## 脆弱性対応の優先順位付け
grypeは脆弱性の重要度（CRITICAL、HIGH、MEDIUM、LOW）を表示します。以下の観点で対応の優先順位を決めることができます。

- 重要度
- 影響を受けるコンポーネントの重要性
- 修正の容易さ
- 実際のエクスプロイト可能性

## 定期的なスキャンの自動化
以下のようなタイミングでの自動スキャンを推奨します。

- コミット時
- プルリクエスト作成時
- 定期的（週次など）
- デプロイメント前

# まとめ

syftとgrypeを活用することで、以下のメリットが得られます：

- プロジェクトの依存関係の可視化
- 潜在的な脆弱性の早期発見
- CI/CDパイプラインでの自動化
- 継続的なセキュリティ管理の実現

特にJavaとNode.jsのプロジェクトでは、数多くの依存パッケージを使用することが一般的なため、これらのツールによる継続的な監視が重要です。

# 参考文献

> [https://github.com/anchore/syft:embed]

> [https://github.com/anchore/grype:embed]
