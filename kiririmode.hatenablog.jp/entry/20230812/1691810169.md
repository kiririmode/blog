---
Title: 時系列解析
Category:
- statistics
Date: 2023-08-12T12:16:09+09:00
URL: https://kiririmode.hatenablog.jp/entry/20230812/1691810169
EditURL: https://blog.hatena.ne.jp/kiririmode/kiririmode.hatenablog.jp/atom/entry/820878482957686224
---

横軸が時間となるような時系列データは、以下の3つに分解できるという考え方があります。

| 種類 | 略 | 意味　|
| -- | -- | -- |
| 傾向変動 (循環変動を含む) | TC (Trend-cycle variation) | 基本的な長期にわたる動きを表す変動 |
| 季節変動 | S (Seasonal variation) | 一年を周期として循環を繰り返す変動 |
| 不規則変動 | I (Irregular variation) | 規則的ではない変動 |

実際の時系列データ$y\_t$を上記3つでどのように組み合わせるかについては、大きく分けて乗法モデルと加法モデルがありますが、ここでは加法モデルを扱います。加法モデルでは$y\_t$は以下の式で表現します。

$$
y\_t = \text{TC} \_{t} + S\_{t} + I\_{t}
$$

$y\_{t}$は観測値なので与えられているわけですが、右辺の各要素はわかっていません。これらは計算によって推定することになります。

# 傾向変動の推定

傾向変動には周期的な動きは含まれません。このため、$\text{TC}\_{t}$は移動平均や指数平滑法を用いて抽出が可能です。ここでは移動平均を扱います。
ある時点$t$での値を$\hat{\text{TC}\_{t}}$とすると、$k$時点前の値から$k$時点後までの$2k+1$個の値を用いて、当該の値は以下の式で表現されます。これが$(2k+1)$項移動平均ですね。
周期的なデータは、移動平均の式の中で全て「ならされる」ため、抽出されるのは長期的なデータのみ、という考え方です。

$$
\hat{\text{TC}\_{t}} = \sum\_{s=t-k} ^{t+k} \frac{y\_{s}}{2k+1}
$$

移動平均で扱う項数が奇数であれば上式で良いのですが、必ずしもそうはなりません。例えば月次での売り上げデータを考えると、その周期は12ヶ月であり、移動平均を取るべき項数は偶数になります。このような場合は端点となる項を1/2にすることで移動平均を計算します。

$$
\hat{\text{TC}\_{t}} = \left(\frac{y\_{t-6}}{2} + y\_{t-5} + y\_{t-4} + \cdots + y\_{t+5} + \frac{y\_{t+6}}{2} \right) / 12
$$

# 季節変動と不規則変動

観測値$y\_{t}$から傾向変動を引いた$w\_{t}=y\_{t}-\hat{\text{TC}\_{t}}$は、季節変動$S\_{t}$と不規則変動$I\_{t}$を含んでいます。月毎に$\lbrace w\_{t} \rbrace$の平均をとり、平均を0とすることを目的に月別平均からそれら平均を引くことで、季節変動成分$\hat{S\_{t}}$が抽出できます。

不規則変動$\hat{I\_{t}}$は以下の式で求められます。

$$
\hat{I\_{t}} = y\_{t} - \hat{\text{TC}\_{t}}-\hat{S\_{t}}
$$
